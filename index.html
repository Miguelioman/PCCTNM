<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <title>TNM Dashboard – Plaveiselcelcarcinoom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0b1020;
      --fg: #e9ecff;
      --muted: #aab2e6;
      --line: #24315e;
      --sel: #1a2550;
      --selLine: #7aa2ff;
      --card: #121a33;
      --low: #41d18a;
      --mid: #ffcc66;
      --high: #ff6b7a;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg);
      color: var(--fg);
      padding: 14px;
      margin: 0;
    }

    h1 {
      font-size: 18px;
      margin: 0 0 8px 0;
    }

    .hint {
      color: var(--muted);
      font-size: 12px;
      margin-bottom: 10px;
      line-height: 1.35;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      align-items: start;
    }

    @media (max-width: 980px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .section {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      margin-bottom: 12px;
      background: rgba(18, 26, 51, .28);
    }

    .section > b {
      display: block;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .toggle {
      display: flex;
      gap: 6px;
      margin-bottom: 6px;
    }

    .toggle button {
      flex: 1;
      padding: 6px 8px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(0, 0, 0, .2);
      color: var(--fg);
      cursor: pointer;
      font-weight: bold;
      font-size: 12px;
    }

    .toggle button.active {
      background: var(--sel);
      border-color: var(--selLine);
    }

    /* Shared option style */
    .item,
    .radioRow {
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 8px 10px;
      margin: 6px 0;
      cursor: pointer;
      transition: background .15s, border-color .15s;
      background: rgba(0, 0, 0, .10);
      color: inherit;
      font-size: 13px;
      line-height: 1.1;
      display: flex;
      gap: 8px;
      align-items: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .item:hover,
    .radioRow:hover {
      border-color: var(--selLine);
    }

    .item.active,
    .radioRow.active {
      background: var(--sel);
      border-color: var(--selLine);
    }

    .code {
      font-weight: bold;
      font-family: monospace;
      display: inline-block;
      min-width: 62px;
      font-size: 17px;
      line-height: 1;
    }

    .radioRow {
      align-items: center;
    }

    .radioRow input {
      margin: 0 0 0 2px;
      flex: 0 0 auto;
    }

    .text {
      flex: 1 1 auto;
      min-width: 0;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Conclusion */
    .resultBlock {
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 10px;
      background: var(--card);
      line-height: 1.35;
      font-family: inherit;
      font-size: 13px;
    }

    .muted {
      color: var(--muted);
    }

    .mono {
      font-family: monospace;
    }

    .risk-low {
      color: var(--low);
      font-weight: bold;
    }

    .risk-mid {
      color: var(--mid);
      font-weight: bold;
    }

    .risk-high {
      color: var(--high);
      font-weight: bold;
    }

    .policy {
      margin-top: 10px;
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 10px;
      background: rgba(0, 0, 0, .18);
      font-family: inherit;
      font-size: 13px;
      line-height: 1.35;
    }

    .policy h4 {
      margin: 8px 0 4px 0;
      font-size: 13px;
    }

    /* Tighten paragraphs inside policy */
    .policy p {
      margin: 6px 0;
    }
  </style>
</head>

<body>

  <h1>TNM Dashboard – Plaveiselcelcarcinoom</h1>
  <div class="hint">
    Opties staan op één regel; hover toont volledige tekst. Recidief wordt apart gescoord (default: nee).
  </div>

  <div class="grid">

    <div class="section">
      <b>T – Primaire tumor</b>

      <div class="item" data-group="T" data-value="T1" title="T1: tumor ≤ 2 cm">
        <span class="code">T1</span><span class="text">tumor ≤ 2 cm</span>
      </div>

      <div class="item" data-group="T" data-value="T2" title="T2: tumor > 2 cm en ≤ 4 cm">
        <span class="code">T2</span><span class="text">tumor &gt; 2 cm en ≤ 4 cm</span>
      </div>

      <div class="item" data-group="T" data-value="T3" title="T3: tumor > 4 cm of minimale boterosie of perineurale invasie (in zenuwen &gt; 0,1 mm of diepe zenuwen (&gt; dermis) of diepe invasie)">
        <span class="code">T3</span><span class="text">tumor &gt; 4 cm of minimale boterosie of perineurale invasie (in zenuwen &gt; 0,1 mm of diepe zenuwen &gt; dermis of diepe invasie)</span>
      </div>

      <div class="item" data-group="T" data-value="T4a" title="T4a: tumor met bot/beenmerginvasie">
        <span class="code">T4a</span><span class="text">tumor met bot/beenmerginvasie</span>
      </div>

      <div class="item" data-group="T" data-value="T4b" title="T4b: tumor met schedelbasisinvasie en/of schedelbasisforamen betrokkenheid">
        <span class="code">T4b</span><span class="text">tumor met schedelbasisinvasie en/of schedelbasisforamen betrokkenheid</span>
      </div>
    </div>

    <div class="section">
      <b>N – Regionale lymfeklieren</b>
      <div class="toggle">
        <button id="btnClinical" class="active" type="button">Klinisch</button>
        <button id="btnPath" type="button">Pathologisch</button>
      </div>
      <div id="Noptions"></div>
    </div>

    <div class="section">
      <b>M – Metastasen op afstand</b>

      <div class="item" data-group="M" data-value="M0" title="M0: geen metastasen op afstand">
        <span class="code">M0</span><span class="text">geen metastasen op afstand</span>
      </div>

      <div class="item" data-group="M" data-value="M1" title="M1: metastasen op afstand">
        <span class="code">M1</span><span class="text">metastasen op afstand</span>
      </div>
    </div>

  </div>

  <div class="section">
    <b>Recidief</b>

    <label class="radioRow" title="Geen recidief">
      <input type="radio" name="recidief" value="nee" checked>
      <span class="text">Nee</span>
    </label>

    <label class="radioRow" title="Recidief tumor (altijd hoog-risico)">
      <input type="radio" name="recidief" value="ja">
      <span class="text">Ja (altijd hoog-risico)</span>
    </label>
  </div>

  <div class="section">
    <b>Histopathologie / tumorstatus</b>

    <label class="radioRow" title="Slecht gedifferentieerde of ongedifferentieerde tumor">
      <input type="radio" name="histo" value="poor">
      <span class="text">Slecht gedifferentieerde of ongedifferentieerde tumor</span>
    </label>

    <label class="radioRow" title="Lymfangio-invasie">
      <input type="radio" name="histo" value="lymph">
      <span class="text">Lymfangio-invasie</span>
    </label>

    <label class="radioRow" title="Dermale perineurale invasie van elke zenuwdiameter aanwezig buiten de contour van de tumor">
      <input type="radio" name="histo" value="pni">
      <span class="text">Dermale perineurale invasie van elke zenuwdiameter aanwezig buiten de contour van de tumor</span>
    </label>

    <label class="radioRow" title="Geen van bovenstaande histopathologische kenmerken">
      <input type="radio" name="histo" value="none">
      <span class="text">Geen van bovenstaande histopathologische kenmerken</span>
    </label>
  </div>

  <div class="section">
    <b>Conclusie</b>
    <div class="resultBlock" id="output"></div>

    <div class="policy" id="policyBox" style="display:none;">
      <b>Advies</b>
      <div id="policyText" class="muted" style="margin-top:6px;"></div>
    </div>

    <div class="policy" id="imagingBox" style="display:none;">
      <b>Beeldvorming</b>
      <div id="imagingText" class="muted" style="margin-top:6px;"></div>
    </div>
  </div>

  <script>
    let state = { T: null, N: null, M: null };
    let nMode = "clinical";
    let recidief = "nee";

    const Nclinical = [
      ["N0", "geen regionale lymfekliermetastase"],
      ["N1", "1 ipsilaterale lymfekliermetastase ≤ 3 cm zonder extranodale extensie"],
      ["N2a", "1 ipsilaterale lymfekliermetastase 3 - 6 cm zonder extranodale extensie"],
      ["N2b", "multipele ipsilaterale lymfekliermetastasen < 6 cm zonder extranodale extensie"],
      ["N2c", "bilaterale of contralaterale lymfekliermetastasen < 6 cm zonder extranodale extensie"],
      ["N3a", "lymfekliermetastase > 6 cm zonder extranodale extensie"],
      ["N3b", "lymfekliermetastase(n) met klinisch extranodale extensie"]
    ];

    const Npath = [
      ["N0", "geen regionale lymfekliermetastase"],
      ["N1", "1 ipsilaterale lymfekliermetastase ≤ 3 cm zonder extranodale extensie"],
      ["N2a", "ipsilaterale of contralaterale lymfekliermetastase ≤ 3 cm en extranodale extensie of 1 ipsilaterale lymfekliermetastase 3-6 cm zonder extranodale extensie"],
      ["N2b", "multipele ipsilaterale lymfekliermetastasen < 6 cm zonder extranodale extensie"],
      ["N2c", "bilaterale of contralaterale lymfekliermetastasen < 6 cm zonder extranodale extensie"],
      ["N3a", "lymfekliermetastase > 6 cm zonder extranodale extensie"],
      ["N3b", "1 ipsilaterale lymfekliermetastase > 3 cm en extranodale extensie of multipele, ipsilaterale, contralaterale of bilaterale lymfekliermetastasen met extranodale extensie"]
    ];

    function nPrefix() {
      return (nMode === "clinical") ? "c" : "p";
    }

    function nDisplay() {
      return state.N ? `${nPrefix()}${state.N}` : "Nx";
    }

    function tGroup(T) {
      if (!T) return null;
      if (T === "T4a" || T === "T4b") return "T4";
      return T;
    }

    function nGroup(N) {
      if (!N) return null;
      if (N === "N0" || N === "N1") return N;
      if (N.startsWith("N2")) return "N2";
      if (N.startsWith("N3")) return "N3";
      return N;
    }

    function bepaalStadium(T, N, M) {
      const TG = tGroup(T);
      const NG = nGroup(N);
      if (!TG || !NG || !M) return "?";
      if (M === "M1") return "IV";

      if (TG === "T1" && NG === "N0" && M === "M0") return "I";
      if (TG === "T2" && NG === "N0" && M === "M0") return "II";
      if (TG === "T3" && NG === "N0" && M === "M0") return "III";
      if (["T1", "T2", "T3"].includes(TG) && NG === "N1" && M === "M0") return "III";
      if (["T1", "T2", "T3"].includes(TG) && NG === "N2" && M === "M0") return "IV";
      if (NG === "N3" && M === "M0") return "IV";
      if (TG === "T4" && M === "M0") return "IV";
      return "?";
    }

    function bepaalRisico(T, h) {
      if (!T || !h) return null;
      if (recidief === "ja") return { label: "Hoog-risico", cls: "risk-high" };

      const TG = tGroup(T);
      const hasRiskFactor = (h !== "none");

      if (T === "T1" && !hasRiskFactor) return { label: "Laag-risico", cls: "risk-low" };
      if ((TG === "T2" && !hasRiskFactor) || (TG === "T1" && hasRiskFactor)) return { label: "Intermediair-risico", cls: "risk-mid" };
      if (TG === "T3" || TG === "T4" || (TG === "T2" && hasRiskFactor)) return { label: "Hoog-risico", cls: "risk-high" };

      return null;
    }

    function beleidTekst(r, Nbase) {
      const heeftRegionaleLymfadenopathie = !!(Nbase && Nbase !== "N0");
      const beeldvorming = (()=>{
        if(r === "Hoog-risico"){
          return "Verricht in de diagnostische fase bij hoog-risico cPCC een echografie die gecombineerd kan worden met een cytologische punctie van radiologisch suspecte lymfklieren, bij voorkeur in één sessie.";
        }
        if(r === "Laag-risico"){
          return "Verricht in de diagnostische fase bij laag-risico cPCC met regionale lymfadenopathie en/of klinisch palpabele lymfklieren een echografie die gecombineerd kan worden met een cytologische punctie van radiologisch suspecte lymfklieren, bij voorkeur in één sessie.";
        }
        if(r === "Intermediair-risico"){
          return "Verricht in de diagnostische fase bij intermediair-risico cPCC met regionale lymfadenopathie en/of klinisch palpabele lymfklieren een echografie die gecombineerd kan worden met een cytologische punctie van radiologisch suspecte lymfklieren, bij voorkeur in één sessie.";
        }
        return "—";
      })();

      if(r==="Laag-risico") return `
        <h4>Excisie</h4>
        Conventionele excisie met een marge van ≥4 mm (met een vrije histologisch marge van ≥1 mm).
        <h4>Follow-up</h4>
        Verricht na radicale excisie een post-operatieve controle binnen 3 maanden en een controle 1 keer per 6–12 maanden gedurende de eerste twee jaar.
        <h4>Beeldvorming</h4>
        ${beeldvorming}
      `;
      if(r==="Intermediair-risico") return `
        <h4>Excisie</h4>
        Conventionele excisie met een marge van ≥6 mm (met een vrije histologisch marge ≥ 2 mm).
        <h4>Follow-up</h4>
        Verricht na radicale excisie een controle 1 keer per 3–4 maanden gedurende de eerste twee jaar en 1 keer in het derde jaar.
        <h4>Beeldvorming</h4>
        ${beeldvorming}
      `;
      if(r==="Hoog-risico") return `
        <h4>Excisie</h4>
        Conventionele excisie met een marge van ≥10 mm (met een vrije histologisch marge ≥ 2 mm).
        <h4>Follow-up</h4>
        Verricht na radicale excisie een controle 1 keer per 3–4 maanden gedurende de eerste twee jaar en 1 keer per jaar gedurende het derde, vierde en vijfde jaar.
        <h4>Beeldvorming</h4>
        ${beeldvorming}
      `;
      return "";
    }

    // T & M clicks
    document.querySelectorAll(".item[data-group=T]").forEach(i=>{
      i.onclick = ()=>{
        document.querySelectorAll(".item[data-group=T]").forEach(x=>x.classList.remove("active"));
        i.classList.add("active");
        state.T = i.dataset.value;
        update();
      };
    });
    document.querySelectorAll(".item[data-group=M]").forEach(i=>{
      i.onclick = ()=>{
        document.querySelectorAll(".item[data-group=M]").forEach(x=>x.classList.remove("active"));
        i.classList.add("active");
        state.M = i.dataset.value;
        update();
      };
    });

    // N toggle
    document.getElementById("btnClinical").onclick = ()=>{
      nMode = "clinical";
      document.getElementById("btnClinical").classList.add("active");
      document.getElementById("btnPath").classList.remove("active");
      state.N = null;
      renderN();
      update();
    };
    document.getElementById("btnPath").onclick = ()=>{
      nMode = "path";
      document.getElementById("btnPath").classList.add("active");
      document.getElementById("btnClinical").classList.remove("active");
      state.N = null;
      renderN();
      update();
    };

    // Recidief selection + highlight
    document.querySelectorAll('input[name="recidief"]').forEach(r=>{
      const row = r.closest(".radioRow");
      row.addEventListener("click", ()=>{
        r.checked = true;
        r.dispatchEvent(new Event("change", {bubbles:true}));
      });
      r.onchange = ()=>{
        recidief = r.value;
        document.querySelectorAll('input[name="recidief"]').forEach(x=>{
          x.closest(".radioRow").classList.remove("active");
        });
        row.classList.add("active");
        update();
      };
    });

    // Histopathology selection + highlight
    document.querySelectorAll('input[name="histo"]').forEach(r=>{
      const row = r.closest(".radioRow");
      row.addEventListener("click", ()=>{
        r.checked = true;
        r.dispatchEvent(new Event("change", {bubbles:true}));
      });
      r.onchange = ()=>{
        histoChoice = r.value;
        document.querySelectorAll(".radioRow").forEach(x=>x.classList.remove("active"));
        row.classList.add("active");
        update();
      };
    });

    // N options rendering
    function renderN(){
      const box = document.getElementById("Noptions");
      box.innerHTML = "";
      const arr = (nMode === "clinical") ? Nclinical : Npath;

      arr.forEach(([code, def])=>{
        const shown = `${nPrefix()}${code}`;
        const div = document.createElement("div");
        div.className = "item" + (state.N === code ? " active" : "");
        div.dataset.group = "N";
        div.dataset.value = code;
        div.title = `${shown}: ${def}`;
        div.innerHTML = `<span class="code">${shown}</span><span class="text">${def}</span>`;
        div.onclick = ()=>{
          box.querySelectorAll(".item").forEach(x=>x.classList.remove("active"));
          div.classList.add("active");
          state.N = code;
          update();
        };
        box.appendChild(div);
      });
    }

    // Update function
    function update(){
      const Tdisp = state.T || "Tx";
      const Ndisp = nDisplay();
      const Mdisp = state.M || "Mx";

      let html = `<div><b>TNM:</b> ${Tdisp} ${Ndisp} ${Mdisp}</div>`;

      const allTNM = !!(state.T && state.N && state.M);
      if(allTNM){
        html += `<div style="margin-top:6px;"><b>Stadium:</b> ${bepaalStadium(state.T, state.N, state.M)}</div>`;
      } else {
        html += `<div class="muted" style="margin-top:6px;">Stadium wordt getoond zodra T, N en M zijn ingevuld.</div>`;
      }

      const risk = bepaalRisico(state.T, histoChoice);

      if(risk){
        html += `<div style="margin-top:6px;"><b>Risicogroep:</b> <span class="${risk.cls}">${risk.label}</span></div>`;
      } else {
        html += `<div class="muted" style="margin-top:6px;"><b>Risicogroep:</b> wordt getoond zodra T én één histopathologie/tumorstatus-optie zijn gekozen.</div>`;
      }

      document.getElementById("output").innerHTML = html;

      const policyBox = document.getElementById("policyBox");
      const policyText = document.getElementById("policyText");

      if(allTNM && risk){
        policyBox.style.display = "block";
        policyText.innerHTML = beleidTekst(risk.label, state.N);
      } else {
        policyBox.style.display = "none";
        policyText.innerHTML = "";
      }
    }

    // Init
    renderN();
    update();
  </script>

</body>
</html>
 
